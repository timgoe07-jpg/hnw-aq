{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/api.service\";\nimport * as i2 from \"../../services/auth.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"../match-results/match-results.component\";\nfunction ProfileUploadComponent_div_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵtext(1, \"Matching profiles...\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProfileUploadComponent_div_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r0.error);\n  }\n}\nfunction ProfileUploadComponent_app_match_results_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-match-results\", 13);\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"results\", ctx_r0.results)(\"filterPersona\", ctx_r0.filterPersona)(\"minScore\", ctx_r0.filterMinScore);\n  }\n}\nexport let ProfileUploadComponent = /*#__PURE__*/(() => {\n  class ProfileUploadComponent {\n    constructor(api, auth) {\n      this.api = api;\n      this.auth = auth;\n      this.jsonInput = \"\";\n      this.parsedProfiles = [];\n      this.results = [];\n      this.loading = false;\n      this.filterPersona = \"\";\n      this.filterMinScore = 0;\n      this.useAi = false;\n      this.linkedInConnected = false;\n    }\n    ngOnInit() {\n      this.linkedInConnected = this.auth.isConnected();\n    }\n    onJsonSubmit() {\n      this.error = undefined;\n      try {\n        const parsed = JSON.parse(this.jsonInput);\n        if (!Array.isArray(parsed)) {\n          throw new Error(\"JSON should be an array of profiles\");\n        }\n        this.parsedProfiles = parsed;\n        this.runMatch();\n      } catch (err) {\n        this.error = err.message;\n      }\n    }\n    onCsvSelected(event) {\n      const file = event.target.files[0];\n      if (!file) return;\n      const reader = new FileReader();\n      reader.onload = e => {\n        const text = e.target.result;\n        this.parsedProfiles = this.parseCsv(text);\n        this.runMatch();\n      };\n      reader.readAsText(file);\n    }\n    parseCsv(text) {\n      const rows = text.split(/\\r?\\n/).filter(l => l.trim().length);\n      if (!rows.length) return [];\n      const [headerLine, ...lines] = rows;\n      const headers = headerLine.split(\",\").map(h => h.trim());\n      return lines.map(line => {\n        const cols = line.split(\",\").map(c => c.trim());\n        const row = {};\n        headers.forEach((h, i) => row[h] = cols[i]);\n        return {\n          full_name: row.name || row.full_name,\n          current_title: row.title || row.current_title,\n          current_company: row.company || row.current_company,\n          about_summary: row.summary || row.about_summary,\n          industry: row.industry,\n          headline: row.headline\n        };\n      });\n    }\n    runMatch() {\n      if (!this.parsedProfiles.length) {\n        this.error = \"No profiles to match.\";\n        return;\n      }\n      this.loading = true;\n      const req$ = this.useAi ? this.api.matchProfilesAi({\n        profiles: this.parsedProfiles\n      }) : this.api.matchProfiles({\n        profiles: this.parsedProfiles\n      });\n      req$.subscribe({\n        next: resp => {\n          this.results = resp.results;\n          this.loading = false;\n        },\n        error: err => {\n          this.error = err.message || \"Match request failed\";\n          this.loading = false;\n        }\n      });\n    }\n    connectLinkedIn() {\n      this.auth.startLinkedInLogin();\n    }\n    static {\n      this.ɵfac = function ProfileUploadComponent_Factory(t) {\n        return new (t || ProfileUploadComponent)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.AuthService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: ProfileUploadComponent,\n        selectors: [[\"app-profile-upload\"]],\n        decls: 31,\n        vars: 7,\n        consts: [[1, \"card\", 2, \"margin-bottom\", \"1rem\"], [1, \"muted\"], [\"rows\", \"8\", \"placeholder\", \"[{\\\"full_name\\\": \\\"Jane\\\", \\\"title\\\": \\\"Analyst\\\"}]\", 3, \"ngModelChange\", \"ngModel\"], [1, \"btn\", 3, \"click\"], [2, \"margin\", \"1rem 0\"], [\"type\", \"file\", \"accept\", \".csv\", 3, \"change\"], [2, \"display\", \"flex\", \"gap\", \"1rem\", \"margin-top\", \"1rem\"], [\"placeholder\", \"e.g. Retirees\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"number\", \"min\", \"0\", \"max\", \"100\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"checkbox\", 3, \"ngModelChange\", \"ngModel\"], [\"class\", \"card\", 4, \"ngIf\"], [3, \"results\", \"filterPersona\", \"minScore\", 4, \"ngIf\"], [1, \"card\"], [3, \"results\", \"filterPersona\", \"minScore\"]],\n        template: function ProfileUploadComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n            i0.ɵɵtext(2, \"Upload or paste profiles\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(3, \"p\", 1);\n            i0.ɵɵtext(4, \"Provide JSON array or a CSV with columns: name, title, company, summary, industry.\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(5, \"label\");\n            i0.ɵɵtext(6, \"Paste JSON\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(7, \"textarea\", 2);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfileUploadComponent_Template_textarea_ngModelChange_7_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.jsonInput, $event) || (ctx.jsonInput = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"button\", 3);\n            i0.ɵɵlistener(\"click\", function ProfileUploadComponent_Template_button_click_8_listener() {\n              return ctx.onJsonSubmit();\n            });\n            i0.ɵɵtext(9, \"Match JSON\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(10, \"div\", 4);\n            i0.ɵɵtext(11, \"or\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(12, \"label\");\n            i0.ɵɵtext(13, \"Upload CSV\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(14, \"input\", 5);\n            i0.ɵɵlistener(\"change\", function ProfileUploadComponent_Template_input_change_14_listener($event) {\n              return ctx.onCsvSelected($event);\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(15, \"div\", 6)(16, \"div\")(17, \"label\");\n            i0.ɵɵtext(18, \"Filter by persona name\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(19, \"input\", 7);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfileUploadComponent_Template_input_ngModelChange_19_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.filterPersona, $event) || (ctx.filterPersona = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(20, \"div\")(21, \"label\");\n            i0.ɵɵtext(22, \"Minimum score\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(23, \"input\", 8);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfileUploadComponent_Template_input_ngModelChange_23_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.filterMinScore, $event) || (ctx.filterMinScore = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(24, \"div\")(25, \"label\");\n            i0.ɵɵtext(26, \"Use AI (OpenAI/LangChain)\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(27, \"input\", 9);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfileUploadComponent_Template_input_ngModelChange_27_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.useAi, $event) || (ctx.useAi = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵtemplate(28, ProfileUploadComponent_div_28_Template, 2, 0, \"div\", 10)(29, ProfileUploadComponent_div_29_Template, 2, 1, \"div\", 10)(30, ProfileUploadComponent_app_match_results_30_Template, 1, 3, \"app-match-results\", 11);\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(7);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.jsonInput);\n            i0.ɵɵadvance(12);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.filterPersona);\n            i0.ɵɵadvance(4);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.filterMinScore);\n            i0.ɵɵadvance(4);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.useAi);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.loading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.error);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.results.length);\n          }\n        },\n        dependencies: [i3.NgIf, i4.DefaultValueAccessor, i4.NumberValueAccessor, i4.CheckboxControlValueAccessor, i4.NgControlStatus, i4.MinValidator, i4.MaxValidator, i4.NgModel, i5.MatchResultsComponent],\n        styles: [\"label[_ngcontent-%COMP%]{display:block;margin:.5rem 0 .25rem}textarea[_ngcontent-%COMP%]{min-height:150px}\"]\n      });\n    }\n  }\n  return ProfileUploadComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}